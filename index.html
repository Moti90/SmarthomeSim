<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smarthome Simulator</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè†</text></svg>">
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Firebase SDK v8 (Compatible with GitHub Pages) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-functions.js"></script>
</head>
<body>
    <!-- Login Container -->
    <div id="login-container" class="container">
        <div class="login-card">
            <div class="logo">
                <img src="LOGO.png" alt="Smarthome Logo" class="logo-image">
            </div>
            
            <form id="login-form" class="auth-form">
                <div class="input-group">
                    <input type="email" id="email" placeholder="Email" required>
                </div>
                <div class="input-group">
                            <input type="password" id="password" placeholder="Adgangskode" autocomplete="current-password" required>
                </div>
                <button type="submit" class="btn btn-primary">Log Ind</button>
            </form>
            
            <div class="auth-links">
                <a href="#" id="register-link">Opret konto</a>
                <a href="#" id="forgot-link">Glemt adgangskode?</a>
            </div>
        </div>
    </div>

    <!-- Register Container -->
    <div id="register-container" class="container hidden">
        <div class="register-card">
            <div class="logo">
                <img src="LOGO.png" alt="Smarthome Logo" class="logo-image">
                <p>Opret Konto</p>
            </div>
            
            <form id="register-form" class="auth-form">
                <div class="input-group">
                    <input type="email" id="register-email" placeholder="Email" required>
                </div>
                <div class="input-group">
                            <input type="password" id="register-password" placeholder="Adgangskode" autocomplete="new-password" required>
                </div>
                <button type="submit" class="btn btn-primary">Opret Konto</button>
            </form>
            
            <div class="auth-links">
                <a href="#" id="login-back-link">Tilbage til login</a>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container" class="container hidden">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="header-left">
                    <div class="logo-small">
                        <img src="LOGO.png" alt="Logo" class="logo-icon">
                        <span class="app-title">Smarthome Simulator</span>
                    </div>
                </div>
                
                <nav class="header-nav">
                    <button class="nav-btn active" data-tab="home">
                        <span class="nav-icon">‚åÇ</span>
                        <span class="nav-label">Forside</span>
                    </button>
                    <button class="nav-btn" data-tab="elearning">
                        <span class="nav-icon">‚óä</span>
                        <span class="nav-label">E-Learning</span>
                    </button>
                    <button class="nav-btn advanced-tab" data-tab="advanced">
                        <span class="nav-icon">‚òÜ</span>
                        <span class="nav-label">Advanced</span>
                    </button>
                    <button class="nav-btn" data-tab="smarthome">
                        <span class="nav-icon">‚ñ∂</span>
                        <span class="nav-label">Smarthome Sim</span>
                    </button>
                    <button class="nav-btn" data-tab="settings">
                        <span class="nav-icon">‚öô</span>
                        <span class="nav-label">Indstillinger</span>
                    </button>
                </nav>
                
                <div class="header-right">
                    <span id="user-info" class="user-info">rasmusjakobsen1990@gmail.com</span>
                    <button id="logout-btn" class="logout-btn">Log Ud</button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Forside Tab -->
            <div id="home-tab" class="tab-content active">
                <div class="content-section">
                    <div class="welcome-section">
                        <h1>Velkommen til Smarthome Simulator</h1>
                        <p class="subtitle">Din intelligente hjemmestyring starter her</p>
                    </div>
                    
                    <div class="video-section">
                        <div class="video-container">
                            <video 
                                id="intro-video" 
                                class="intro-video" 
                                controls 
                                preload="metadata"
                                aria-label="Smarthome Simulator Introduktionsvideo">
                                <source src="Introvideo.mp4" type="video/mp4">
                                <p>Din browser underst√∏tter ikke video elementet. <a href="Introvideo.mp4">Download videoen her</a>.</p>
                            </video>
                        </div>
                    </div>
                </div>
            </div>

            <!-- E-Learning Tab -->
            <div id="elearning-tab" class="tab-content">
                <div class="elearning-container">
                    <!-- Header Section -->
                    <div class="elearning-header">
                        <div class="header-content">
                            <h1>Smarthome Teknologi</h1>
                        </div>
                        <div class="header-stats">
                            <div class="stat-card">
                                <div class="stat-icon">üì°</div>
                                <div class="stat-info">
                                    <span class="stat-number">10+</span>
                                    <span class="stat-label">Sensortyper</span>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">üß†</div>
                                <div class="stat-info">
                                    <span class="stat-number">74+</span>
                                    <span class="stat-label">Quiz Sp√∏rgsm√•l</span>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">üèÜ</div>
                                <div class="stat-info">
                                    <span class="stat-number">0%</span>
                                    <span class="stat-label">Samlet Fremgang</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Main Learning Interface -->
                    <div class="learning-interface">
                        <!-- Topic Selection Panel -->
                        <div class="topic-panel">
                            <div class="panel-header">
                                <h2>V√¶lg Emne</h2>
                                <div class="search-box">
                                    <input type="text" id="topic-search" placeholder="S√∏g emner...">
                                    <span class="search-icon">üîç</span>
                                </div>
                            </div>
                            
                            <div class="topics-grid">
                                <!-- Sensoere Topic -->
                                <div class="topic-card" data-topic="sensoere">
                                    <div class="topic-icon">üì°</div>
                                    <div class="topic-info">
                                        <h3>Sensoere</h3>
                                        <p>L√¶r om forskellige typer sensoere og deres anvendelse</p>
                                        <div class="topic-stats">
                                            <span class="subtopic-count">10 underemner</span>
                                            <span class="completion-rate">0% gennemf√∏rt</span>
                                        </div>
                                    </div>
                                    <div class="topic-arrow">‚Üí</div>
                                </div>

                                <!-- Forbindelsestyper Topic -->
                                <div class="topic-card" data-topic="forbindelser">
                                    <div class="topic-icon">üîó</div>
                                    <div class="topic-info">
                                        <h3>Forbindelsestyper</h3>
                                        <p>Forst√• forskellige kommunikationsprotokoller og netv√¶rk</p>
                                        <div class="topic-stats">
                                            <span class="subtopic-count">8 underemner</span>
                                            <span class="completion-rate">0% gennemf√∏rt</span>
                                        </div>
                                    </div>
                                    <div class="topic-arrow">‚Üí</div>
                                </div>

                                <!-- Automatisering Topic -->
                                <div class="topic-card" data-topic="automatisering">
                                    <div class="topic-icon">‚ö°</div>
                                    <div class="topic-info">
                                        <h3>Automatisering</h3>
                                        <p>Opret intelligente automatiseringer og scenarier</p>
                                        <div class="topic-stats">
                                            <span class="subtopic-count">6 underemner</span>
                                            <span class="completion-rate">0% gennemf√∏rt</span>
                                        </div>
                                    </div>
                                    <div class="topic-arrow">‚Üí</div>
                                </div>

                                <!-- Sikkerhed Topic -->
                                <div class="topic-card" data-topic="sikkerhed">
                                    <div class="topic-icon">üîí</div>
                                    <div class="topic-info">
                                        <h3>Sikkerhed & Privatliv</h3>
                                        <p>Beskyt dit smarthome mod trusler og sikkerhedsrisici</p>
                                        <div class="topic-stats">
                                            <span class="subtopic-count">4 underemner</span>
                                            <span class="completion-rate">0% gennemf√∏rt</span>
                                        </div>
                                    </div>
                                    <div class="topic-arrow">‚Üí</div>
                                </div>

                                <!-- Energistyring Topic -->
                                <div class="topic-card" data-topic="energi">
                                    <div class="topic-icon">üå±</div>
                                    <div class="topic-info">
                                        <h3>Energistyring</h3>
                                        <p>Optim√©r energiforbrug og b√¶redygtige l√∏sninger</p>
                                        <div class="topic-stats">
                                            <span class="subtopic-count">5 underemner</span>
                                            <span class="completion-rate">0% gennemf√∏rt</span>
                                        </div>
                                    </div>
                                    <div class="topic-arrow">‚Üí</div>
                                </div>

                                <!-- Fejlfinding Topic -->
                                <div class="topic-card" data-topic="fejlfinding">
                                    <div class="topic-icon">üîß</div>
                                    <div class="topic-info">
                                        <h3>Fejlfinding</h3>
                                        <p>L√¶r at diagnosticere og l√∏se almindelige problemer</p>
                                        <div class="topic-stats">
                                            <span class="subtopic-count">4 underemner</span>
                                            <span class="completion-rate">0% gennemf√∏rt</span>
                                        </div>
                                    </div>
                                    <div class="topic-arrow">‚Üí</div>
                                </div>
                            </div>
                        </div>

                        <!-- Content Panel -->
                        <div class="content-panel">
                            <div class="content-header">
                                <button class="back-btn" id="back-to-topics" style="display: none;">
                                    <span>‚Üê</span> Tilbage til emner
                                </button>
                                <div class="current-topic-info">
                                    <h2 id="current-topic-title">V√¶lg et emne for at begynde</h2>
                                    <p id="current-topic-description">Klik p√• et emne til venstre for at se underemner og begynde l√¶ring</p>
                                </div>
                            </div>

                            <div class="content-body">
                                <!-- Default State -->
                                <div class="welcome-content" id="welcome-content">
                                    <div class="welcome-illustration">
                                        <div class="floating-icons">
                                            <div class="floating-icon" style="--delay: 0s">üì°</div>
                                            <div class="floating-icon" style="--delay: 1s">üîó</div>
                                            <div class="floating-icon" style="--delay: 2s">‚ö°</div>
                                            <div class="floating-icon" style="--delay: 3s">üîí</div>
                                        </div>
                                    </div>
                                    <h3>Velkommen til Smarthome E-Learning!</h3>
                                    <p>Udforsk vores omfattende l√¶ringsmoduler og byg din ekspertise op trin for trin. Hvert emne indeholder detaljerede underemner med interaktive √∏velser og praktiske eksempler.</p>
                                    <div class="quick-stats">
                                        <div class="stat-item">
                                            <span class="stat-number">6</span>
                                            <span class="stat-label">Hovedemner</span>
                                        </div>
                                        <div class="stat-item">
                                            <span class="stat-number">37</span>
                                            <span class="stat-label">Underemner</span>
                                        </div>
                                        <div class="stat-item">
                                            <span class="stat-number">74+</span>
                                            <span class="stat-label">Quiz Sp√∏rgsm√•l</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Subtopic Content -->
                                <div class="subtopics-container" id="subtopics-container" style="display: none;">
                                    <div class="subtopics-grid" id="subtopics-grid">
                                        <!-- Dynamic content will be inserted here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Achievement Panel -->
                    <div class="achievement-panel">
                        <div class="achievement-header">
                            <h3>üèÜ Pr√¶stationer</h3>
                        </div>
                        <div class="achievements-grid">
                            <div class="achievement-badge locked">
                                <div class="badge-icon">ü•á</div>
                                <span>F√∏rste Skridt</span>
                            </div>
                            <div class="achievement-badge locked">
                                <div class="badge-icon">üìö</div>
                                <span>L√¶relyst</span>
                            </div>
                            <div class="achievement-badge locked">
                                <div class="badge-icon">üéØ</div>
                                <span>M√•lrettet</span>
                            </div>
                            <div class="achievement-badge locked">
                                <div class="badge-icon">üíé</div>
                                <span>Ekspert</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Smarthome Sim Tab -->
            <div id="smarthome-tab" class="tab-content">
                <div class="simulator-layout">
                    <div class="floor-plan-section">
                        <div class="floor-plan-container">
                            <img src="plantegning.png" alt="Plantegning" class="floor-plan-image">
                            
                            <!-- Draggable Smart Home Icons -->
                            <div class="smart-icons-container">
                                <!-- Stue Lampe -->
                                <div class="smart-icon" data-device="stue-lampe" data-type="boolean" data-value="false" data-default-left="25" data-default-top="35" data-device-name="Stue Lampe" style="left: 25%; top: 35%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üí°</span>
                                    </div>
                                </div>
                                
                                <!-- Badev√¶relses Lampe -->
                                <div class="smart-icon" data-device="badevaerelse-lampe" data-type="boolean" data-value="false" data-default-left="20" data-default-top="65" data-device-name="Badev√¶relses Lampe" style="left: 20%; top: 65%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üí°</span>
                                    </div>
                                </div>
                                
                                <!-- Sovev√¶relse Lampe -->
                                <div class="smart-icon" data-device="sovevaerelse-lampe" data-type="boolean" data-value="false" data-default-left="75" data-default-top="25" data-device-name="Sovev√¶relse Lampe" style="left: 75%; top: 25%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üí°</span>
                                    </div>
                                </div>
                                
                                <!-- K√∏kken Lampe -->
                                <div class="smart-icon" data-device="koekken-lampe" data-type="boolean" data-value="false" data-default-left="35" data-default-top="75" data-device-name="K√∏kken Lampe" style="left: 35%; top: 75%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üí°</span>
                                    </div>
                                </div>
                                
                                <!-- Spisestue Lampe -->
                                <div class="smart-icon" data-device="spisestue-lampe" data-type="boolean" data-value="false" data-default-left="55" data-default-top="55" data-device-name="Spisestue Lampe" style="left: 55%; top: 55%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üí°</span>
                                    </div>
                                </div>
                                
                                <!-- Vindue Sovev√¶relse -->
                                <div class="smart-icon" data-device="vindue-sovevaerelse" data-type="boolean" data-value="false" data-default-left="15" data-default-top="40" data-device-name="Vindue Sovev√¶relse" style="left: 15%; top: 40%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">ü™ü</span>
                                    </div>
                                </div>
                                
                                <!-- Vindue Stue -->
                                <div class="smart-icon" data-device="vindue-stue" data-type="boolean" data-value="false" data-default-left="85" data-default-top="40" data-device-name="Vindue Stue" style="left: 85%; top: 40%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">ü™ü</span>
                                    </div>
                                </div>
                                
                                <!-- D√∏rl√•s -->
                                <div class="smart-icon" data-device="doerlaas" data-type="boolean" data-value="false" data-default-left="50" data-default-top="15" data-device-name="D√∏rl√•s" style="left: 50%; top: 15%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üîí</span>
                                    </div>
                                </div>
                                
                                <!-- Bev√¶gelsessensor Entre -->
                                <div class="smart-icon" data-device="bevaegelsessensor-entre" data-type="boolean" data-value="false" data-default-left="45" data-default-top="30" data-device-name="Bev√¶gelsessensor Entre" style="left: 45%; top: 30%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üì°</span>
                                    </div>
                                </div>
                                
                                <!-- Bev√¶gelsessensor Stue -->
                                <div class="smart-icon" data-device="bevaegelsessensor-stue" data-type="boolean" data-value="false" data-default-left="30" data-default-top="45" data-device-name="Bev√¶gelsessensor Stue" style="left: 30%; top: 45%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üì°</span>
                                    </div>
                                </div>
                                
                                <!-- Aktuator/Radiator -->
                                <div class="smart-icon" data-device="aktuator-radiator" data-type="boolean" data-value="false" data-default-left="60" data-default-top="40" data-device-name="Aktuator/Radiator" style="left: 60%; top: 40%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üå°Ô∏è</span>
                                    </div>
                                </div>
                                
                                <!-- Udvendig Vejrstation -->
                                <div class="smart-icon" data-device="udvendig-vejrstation" data-type="boolean" data-value="false" data-default-left="10" data-default-top="10" data-device-name="Udvendig Vejrstation" style="left: 10%; top: 10%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üå§Ô∏è</span>
                                    </div>
                                </div>
                                
                                <!-- Badev√¶relse Ventilator -->
                                <div class="smart-icon" data-device="badevaerelse-ventilator" data-type="boolean" data-value="false" data-default-left="25" data-default-top="25" data-device-name="Badev√¶relse Ventilator" style="left: 25%; top: 25%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üåÄ</span>
                                    </div>
                                </div>
                                
                                <!-- Badev√¶relse Fugtm√•ler -->
                                <div class="smart-icon" data-device="badevaerelse-fugtmaaler" data-type="numeric" data-value="45" data-default-left="30" data-default-top="20" data-device-name="Badev√¶relse Fugtm√•ler" style="left: 30%; top: 20%;">
                                    <div class="icon-content">
                                        <span class="icon-symbol">üíß</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                <div class="control-section">
                    <div class="control-panel">
                        <h3>Kontrolpanel</h3>
                        
                        <!-- Weather Indicator -->
                        <div class="weather-indicator">
                            <div class="weather-item">
                                <span class="weather-icon">üå°Ô∏è</span>
                                <span class="weather-value" id="outdoor-temp">15¬∞C</span>
                            </div>
                            <div class="weather-item">
                                <span class="weather-icon">‚òÄÔ∏è</span>
                                <span class="weather-value" id="outdoor-light">M√∏rkt</span>
                            </div>
                        </div>
                        
                        <!-- Scenarie Kontrol -->
                        <div class="scenario-controls">
                            <h4>Scenarier</h4>
                            <div class="scenario-grid">
                                <button class="scenario-btn" data-scenario="morning">
                                    <span class="scenario-icon">üåÖ</span>
                                    <span class="scenario-name">Morgen</span>
                                </button>
                                <button class="scenario-btn" data-scenario="night">
                                    <span class="scenario-icon">üåô</span>
                                    <span class="scenario-name">Nat</span>
                                </button>
                                <button class="scenario-btn" data-scenario="coming-home">
                                    <span class="scenario-icon">üè†</span>
                                    <span class="scenario-name">Kommer Hjem</span>
                                </button>
                                <button class="scenario-btn" data-scenario="leaving-home">
                                    <span class="scenario-icon">üö™</span>
                                    <span class="scenario-name">Forlader Hjemmet</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="device-controls">
                                <div class="control-group">
                                    <h4>Lys</h4>
                                    
                                    <!-- Stue Lampe -->
                                    <div class="control-item">
                                        <label for="stue-lampe-switch">Stue Lampe</label>
                                        <div class="switch-container">
                                            <input type="checkbox" id="stue-lampe-switch" class="lamp-switch" data-device="stue-lampe">
                                            <label for="stue-lampe-switch" class="switch-label"></label>
                                        </div>
                                    </div>
                                    
                                    <!-- Badev√¶relses Lampe -->
                                    <div class="control-item">
                                        <label for="badevaerelse-lampe-switch">Badev√¶relses Lampe</label>
                                        <div class="switch-container">
                                            <input type="checkbox" id="badevaerelse-lampe-switch" class="lamp-switch" data-device="badevaerelse-lampe">
                                            <label for="badevaerelse-lampe-switch" class="switch-label"></label>
                                        </div>
                                    </div>
                                    
                                    <!-- Sovev√¶relse Lampe -->
                                    <div class="control-item">
                                        <label for="sovevaerelse-lampe-switch">Sovev√¶relse Lampe</label>
                                        <div class="switch-container">
                                            <input type="checkbox" id="sovevaerelse-lampe-switch" class="lamp-switch" data-device="sovevaerelse-lampe">
                                            <label for="sovevaerelse-lampe-switch" class="switch-label"></label>
                                        </div>
                                    </div>
                                    
                                    <!-- K√∏kken Lampe -->
                                    <div class="control-item">
                                        <label for="koekken-lampe-switch">K√∏kken Lampe</label>
                                        <div class="switch-container">
                                            <input type="checkbox" id="koekken-lampe-switch" class="lamp-switch" data-device="koekken-lampe">
                                            <label for="koekken-lampe-switch" class="switch-label"></label>
                                        </div>
                                    </div>
                                    
                                    <!-- Spisestue Lampe -->
                                    <div class="control-item">
                                        <label for="spisestue-lampe-switch">Spisestue Lampe</label>
                                        <div class="switch-container">
                                            <input type="checkbox" id="spisestue-lampe-switch" class="lamp-switch" data-device="spisestue-lampe">
                                            <label for="spisestue-lampe-switch" class="switch-label"></label>
                                        </div>
                                    </div>
                                    
                                </div>
                                
                                
                                <div class="control-group">
                                    <h4>Sensorer</h4>
                                    
                                    <!-- Bev√¶gelsessensor Entre -->
                                    <div class="control-item">
                                        <label for="bevaegelsessensor-entre-switch">Bev√¶gelsessensor Entre</label>
                                        <div class="switch-container">
                                            <input type="checkbox" id="bevaegelsessensor-entre-switch" class="lamp-switch" data-device="bevaegelsessensor-entre">
                                            <label for="bevaegelsessensor-entre-switch" class="switch-label"></label>
                                        </div>
                                    </div>
                                    
                                    <!-- Bev√¶gelsessensor Stue -->
                                    <div class="control-item">
                                        <label for="bevaegelsessensor-stue-switch">Bev√¶gelsessensor Stue</label>
                                        <div class="switch-container">
                                            <input type="checkbox" id="bevaegelsessensor-stue-switch" class="lamp-switch" data-device="bevaegelsessensor-stue">
                                            <label for="bevaegelsessensor-stue-switch" class="switch-label"></label>
                                        </div>
                                    </div>
                                    
                                    <!-- Alarmsystem -->
                                    <div class="control-item">
                                        <label for="alarmsystem-switch">Alarmsystem</label>
                                        <div class="switch-container">
                                            <input type="checkbox" id="alarmsystem-switch" class="lamp-switch" data-device="alarmsystem">
                                            <label for="alarmsystem-switch" class="switch-label"></label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="control-group">
                                    <h4>Klima & Milj√∏</h4>
                                    
                                    <!-- Aktuator/Radiator -->
                                    <div class="control-item">
                                        <label for="aktuator-radiator-switch">Aktuator/Radiator</label>
                                        <div class="switch-container">
                                            <input type="checkbox" id="aktuator-radiator-switch" class="lamp-switch" data-device="aktuator-radiator">
                                            <label for="aktuator-radiator-switch" class="switch-label"></label>
                                        </div>
                                    </div>
                                    <div class="control-item">
                                        <label for="radiator-temp-display">Temperatur</label>
                                        <div class="temp-display">
                                            <span id="radiator-temp-display">21.0¬∞C</span>
                                        </div>
                                    </div>
                                    
                                    <!-- Badev√¶relse Ventilator -->
                                    <div class="control-item">
                                        <label for="badevaerelse-ventilator-switch">Badev√¶relse Ventilator</label>
                                        <div class="switch-container">
                                            <input type="checkbox" id="badevaerelse-ventilator-switch" class="lamp-switch" data-device="badevaerelse-ventilator">
                                            <label for="badevaerelse-ventilator-switch" class="switch-label"></label>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Advanced Tab -->
            <div id="advanced-tab" class="tab-content">
                <div class="advanced-container">
                    <div class="advanced-header">
                        <h1>‚ö° Advanced Mode</h1>
                        <p>Avancerede funktioner og eksperimentelle features</p>
                    </div>
                    
                    <div class="advanced-content">
                        <div class="advanced-section">
                            <h2>üîß System Information</h2>
                            <div class="info-grid">
                                <div class="info-card">
                                    <h3>Browser Info</h3>
                                    <p id="browser-info">Loading...</p>
                                </div>
                                <div class="info-card">
                                    <h3>Screen Resolution</h3>
                                    <p id="screen-info">Loading...</p>
                                </div>
                                <div class="info-card">
                                    <h3>Local Storage</h3>
                                    <p id="storage-info">Loading...</p>
                                </div>
                                <div class="info-card">
                                    <h3>Performance</h3>
                                    <p id="performance-info">Loading...</p>
                                </div>
                            </div>
                        </div>

                        <div class="advanced-section">
                            <h2>üß™ Experimental Features</h2>
                            <div class="feature-grid">
                                <div class="feature-card">
                                    <h3>üîÆ AI Assistant</h3>
                                    <p>Intelligent hj√¶lper til smarthome optimering</p>
                                    <button class="btn btn-primary" onclick="window.appManager.toggleAIAssistant()">Aktiver</button>
                                </div>
                                <div class="feature-card">
                                    <h3>üìä Advanced Analytics</h3>
                                    <p>Detaljerede brugerstatistikker og m√∏nstre</p>
                                    <button class="btn btn-primary" onclick="window.appManager.toggleAnalytics()">Aktiver</button>
                                </div>
                                <div class="feature-card">
                                    <h3>üîê Security Scanner</h3>
                                    <p>Automatisk sikkerhedsgennemgang af systemet</p>
                                    <button class="btn btn-primary" onclick="window.appManager.runSecurityScan()">Start Scan</button>
                                </div>
                                <div class="feature-card">
                                    <h3>‚ö° Performance Monitor</h3>
                                    <p>Real-time overv√•gning af system ydeevne</p>
                                    <button class="btn btn-primary" onclick="window.appManager.togglePerformanceMonitor()">Aktiver</button>
                                </div>
                            </div>
                        </div>

                        <div class="advanced-section">
                            <h2>üõ†Ô∏è Developer Tools</h2>
                            <div class="tools-grid">
                                <div class="tool-card">
                                    <h3>Console Access</h3>
                                    <p>Direkte adgang til browser console</p>
                                    <button class="btn btn-secondary" onclick="window.appManager.openConsole()">√Öbn Console</button>
                                </div>
                                <div class="tool-card">
                                    <h3>Data Export</h3>
                                    <p>Eksporter alle applikationsdata</p>
                                    <button class="btn btn-secondary" onclick="window.appManager.exportData()">Eksporter</button>
                                </div>
                                <div class="tool-card">
                                    <h3>Cache Clear</h3>
                                    <p>Ryd browser cache og lokale data</p>
                                    <button class="btn btn-secondary" onclick="window.appManager.clearCache()">Ryd Cache</button>
                                </div>
                                <div class="tool-card">
                                    <h3>System Reset</h3>
                                    <p>Nulstil hele systemet til standard</p>
                                    <button class="btn btn-danger" onclick="window.appManager.systemReset()">Nulstil System</button>
                                </div>
                            </div>
                        </div>

                        <!-- Smarthome Sim Sektion -->
                        <div class="advanced-section">
                            <h2>üè† Smarthome Simulator</h2>
                            <p>Simuler smarthome enheder og test automationsregler i realtid</p>
                            
                            <div class="smarthome-sim-container">
                                <!-- F√∏rste kolonne: Simulation Control -->
                                <div class="sim-column">
                                    <div class="sim-section">
                                        <h3>üìä Simulation Control</h3>
                                        <div class="sim-controls">
                                            <div class="time-controls">
                                                <div class="time-display">
                                                    <span>Klokkesl√¶t: </span>
                                                    <span id="sim-time">21:30</span>
                                                </div>
                                                <div class="day-display">
                                                    <span>Ugedag: </span>
                                                    <span id="sim-day">Mon</span>
                                                </div>
                                            </div>
                                            
                                            <div class="global-variables">
                                                <h4>Globale variabler</h4>
                                                <div class="variable-inputs">
                                                    <input type="text" id="global-var-1" placeholder="fx mode" value="fx mode">
                                                    <input type="text" id="global-var-2" placeholder="fx night" value="fx night">
                                                </div>
                                                <div class="variable-actions">
                                                    <button class="btn btn-primary" onclick="window.appManager.setGlobalVariables()">S√¶t (buffer)</button>
                                                    <button class="btn btn-secondary" onclick="window.appManager.clearAllVariables()">Clear alle</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="sim-section">
                                        <h3>üéõÔ∏è Akt√∏rer</h3>
                                        <div class="actors-grid">
                                            <div class="actor-card" onclick="window.appManager.toggleActor('light')">
                                                <div class="actor-name">Lampe</div>
                                                <div class="actor-status" id="light-status">OFF</div>
                                            </div>
                                            
                                            <div class="actor-card" onclick="window.appManager.openDimmerDialog('dimmer')">
                                                <div class="actor-name">D√¶mper</div>
                                                <div class="actor-status" id="dimmer-status">0%</div>
                                            </div>
                                            
                                            <div class="actor-card" onclick="window.appManager.toggleActor('fan')">
                                                <div class="actor-name">Ventilator</div>
                                                <div class="actor-status" id="fan-status">OFF</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="sim-section">
                                        <h3>üì° Z-Wave Sensorer</h3>
                                        <p class="sensor-description">Z-Wave-inspirerede sensorer mappes til globale variabler</p>
                                        
                                        <div class="sensor-controls">
                                            <select id="sensor-type" onchange="window.appManager.updateSensorStates()">
                                                <option value="">V√¶lg sensor type</option>
                                                <option value="pir">PIR (bev√¶gelse)</option>
                                                <option value="door">D√∏r-/vindueskontakt</option>
                                                <option value="humidity">Fugtighed (%)</option>
                                                <option value="light">Lys (lux)</option>
                                                <option value="wind">Vind (m/s)</option>
                                                <option value="temp">Temperatur (¬∞C)</option>
                                                <option value="smoke">R√∏galarm</option>
                                                <option value="water">Vandl√¶kage</option>
                                                <option value="co2">CO‚ÇÇ (ppm)</option>
                                                <option value="presence">Tilstedev√¶relse</option>
                                                <option value="alarm">Alarm (Armed)</option>
                                                <option value="home">Home Mode</option>
                                            </select>
                                            
                                            <div id="sensor-state-container" style="display: none;">
                                                <!-- Dynamisk indhold baseret p√• sensor type -->
                                            </div>
                                            
                                            <button class="btn btn-primary" onclick="window.appManager.addSensor()" style="display: none;">+ Tilf√∏j sensor</button>
                                        </div>
                                        
                                        <div class="sensors-list" id="sensors-list">
                                            <!-- Sensorer vil blive dynamisk tilf√∏jet her -->
                                        </div>
                                        
                                        <!-- Aktiv√©r √¶ndringer knap flyttet her -->
                                        <div class="sim-actions">
                                            <button class="btn btn-success" onclick="window.appManager.activateChanges()">Aktiv√©r √¶ndringer</button>
                                            <div class="sim-status">Nyeste log nederst ‚Ä¢ Intet trigges f√∏r "Aktiv√©r"</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Anden kolonne: Regler -->
                                <div class="sim-column">
                                    <div class="sim-section">
                                        <h3>‚öôÔ∏è Regler (blok-scener)</h3>
                                        
                                        <div class="rule-builder-sim">
                                            <div class="rule-condition">
                                                <span>IF</span>
                                                <select id="rule-condition-1">
                                                    <option value="always">Altid (ved aktivering)</option>
                                                    <option value="time">Tidspunkt</option>
                                                    <option value="sensor">Sensor v√¶rdi</option>
                                                    <option value="global">Global variabel</option>
                                                </select>
                                                <input type="text" id="rule-value-1" placeholder="(ingen v√¶rdi)">
                                            </div>
                                            
                                            <div class="rule-condition">
                                                <span>AND</span>
                                                <select id="rule-condition-2">
                                                    <option value="">(valgfri)</option>
                                                    <option value="time">Tidspunkt</option>
                                                    <option value="sensor">Sensor v√¶rdi</option>
                                                    <option value="global">Global variabel</option>
                                                </select>
                                                <input type="text" id="rule-value-2" placeholder="v√¶rdi">
                                            </div>
                                            
                                            <div class="rule-condition">
                                                <span>AND</span>
                                                <select id="rule-condition-3">
                                                    <option value="">(valgfri)</option>
                                                    <option value="time">Tidspunkt</option>
                                                    <option value="sensor">Sensor v√¶rdi</option>
                                                    <option value="global">Global variabel</option>
                                                </select>
                                                <input type="text" id="rule-value-3" placeholder="v√¶rdi">
                                            </div>
                                            
                                            <div class="rule-action">
                                                <span>THEN</span>
                                                <select id="rule-action">
                                                    <option value="light_on">Lys ‚Üí T√¶nd</option>
                                                    <option value="light_off">Lys ‚Üí Sluk</option>
                                                    <option value="dimmer">D√¶mper ‚Üí S√¶t v√¶rdi</option>
                                                    <option value="fan_on">Ventilator ‚Üí T√¶nd</option>
                                                    <option value="fan_off">Ventilator ‚Üí Sluk</option>
                                                    <option value="notification">Send notifikation</option>
                                                </select>
                                                <input type="text" id="rule-action-value" placeholder="for push/global/delay">
                                            </div>
                                            
                                            <input type="text" id="rule-name" placeholder="Navn p√• regel (valgfri)">
                                            
                                            <div class="rule-buttons">
                                                <button class="btn btn-success" onclick="window.appManager.addSimRule()">Tilf√∏j regel</button>
                                                <button class="btn btn-danger" onclick="window.appManager.clearAllRules()">Slet alle</button>
                                                <button class="btn btn-secondary" onclick="window.appManager.saveRules()">Gem</button>
                                                <button class="btn btn-secondary" onclick="window.appManager.loadRules()">Hent</button>
                                            </div>
                                        </div>
                                        
                                        <!-- Oprettede Regler -->
                                        <div class="created-rules-section">
                                            <h4>üìã Oprettede Regler</h4>
                                            <div class="created-rules-list" id="created-rules-list">
                                                <!-- Regler vil blive dynamisk tilf√∏jet her -->
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Tredje kolonne: Log & LUA -->
                                <div class="sim-column">
                                    <div class="sim-section">
                                        <h3>üìã Log & LUA</h3>
                                        
                                        <div class="log-controls">
                                            <button class="btn btn-primary" onclick="window.appManager.runRules()">K√∏r regler (RUN)</button>
                                            <button class="btn btn-secondary" onclick="window.appManager.clearLog()">Slet log</button>
                                            <button class="btn btn-secondary" onclick="window.appManager.exportCSV()">CSV</button>
                                        </div>
                                        
                                        <div class="log-filters">
                                            <button class="btn btn-small active" onclick="window.appManager.filterLog('all')">Alle</button>
                                            <button class="btn btn-small" onclick="window.appManager.filterLog('matches')">Matches</button>
                                            <button class="btn btn-small" onclick="window.appManager.filterLog('activation')">Aktivering</button>
                                            <button class="btn btn-small" onclick="window.appManager.filterLog('system')">System</button>
                                        </div>
                                        
                                        <div class="log-output" id="log-output">
                                            <div class="log-entry system">17.12.02 SYS SmartHome Simulator v2.0 (WebView2 SPA) klar.</div>
                                        </div>
                                        
                                        <div class="lua-panels">
                                            <div class="lua-panel">
                                                <h4>ERKL√ÜRINGER (Venstre panel i HC3)</h4>
                                                <div class="lua-content" id="lua-conditions">
                                                    Conditions og triggers kommer her...
                                                </div>
                                                <button class="btn btn-small" onclick="window.appManager.copyLuaConditions()">Kopier venstre panel</button>
                                            </div>
                                            
                                            <div class="lua-panel">
                                                <h4>HANDLINGER (H√∏jre panel i HC3)</h4>
                                                <div class="lua-content" id="lua-actions">
                                                    Actions og regler kommer her...
                                                </div>
                                                <button class="btn btn-small" onclick="window.appManager.copyLuaActions()">Kopier h√∏jre panel</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Indstillinger Tab -->
            <div id="settings-tab" class="tab-content">
                <div class="settings-layout">
                    <div class="settings-header">
                        <h2>Indstillinger</h2>
                    </div>
                    
                    <div class="settings-grid">
                        <!-- Tema Sektion -->
                        <div class="settings-column">
                            <div class="settings-group">
                                <h3>üé® Tema</h3>
                                <p>V√¶lg dit foretrukne tema for applikationen</p>
                                
                                <div class="theme-selector">
                                    <div class="theme-option active" data-theme="default">
                                        <div class="theme-preview theme-blue"></div>
                                        <h4>Moderne Bl√•</h4>
                                        <p>Elegant og futuristisk design</p>
                                    </div>
                                    
                                    <div class="theme-option" data-theme="crimson-gold">
                                        <div class="theme-preview theme-crimson-gold"></div>
                                        <h4>Crimson & Guld</h4>
                                        <p>Elegant sort og crimson med guld accent</p>
                                    </div>
                                    
                                    <div class="theme-option" data-theme="warm-green">
                                        <div class="theme-preview theme-warm-green"></div>
                                        <h4>Varm Gr√∏n</h4>
                                        <p>Behageligt og varmt design</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Brugergr√¶nseflade Sektion -->
                        <div class="settings-column">
                            <div class="settings-group">
                                <h3>üñ•Ô∏è Brugergr√¶nseflade</h3>
                                <p>Tilpas applikationens udseende og adf√¶rd</p>
                                
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Advanced Mode</h4>
                                        <p>Aktiverer avancerede funktioner og en ekstra fane i headeren</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="advanced-mode" onchange="window.appManager.toggleAdvancedMode()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Kompakt Visning</h4>
                                        <p>Reducerer mellemrum og g√∏r indholdet mere kompakt</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="compact-view" onchange="window.appManager.toggleCompactView()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>

                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>H√∏j Kontrast</h4>
                                        <p>√òger kontrasten for bedre l√¶sbarhed</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="high-contrast" onchange="window.appManager.toggleHighContrast()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>

                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>St√∏rre Skrift</h4>
                                        <p>√òger skriftst√∏rrelsen for bedre l√¶sbarhed</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="large-text" onchange="window.appManager.toggleLargeText()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Notifikationer Sektion -->
                        <div class="settings-column">
                            <div class="settings-group">
                                <h3>üîî Notifikationer</h3>
                                <p>Administrer notifikationer og beskeder</p>
                                
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Lydnotifikationer</h4>
                                        <p>Afspil lyd n√•r der kommer notifikationer</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="sound-notifications" onchange="window.appManager.toggleSoundNotifications()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>

                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Desktop Notifikationer</h4>
                                        <p>Vis notifikationer uden for browseren</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="desktop-notifications" onchange="window.appManager.toggleDesktopNotifications()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Data & Sikkerhed Sektion -->
                        <div class="settings-column">
                            <div class="settings-group">
                                <h3>üõ°Ô∏è Data & Sikkerhed</h3>
                                <p>Administrer data og sikkerhedsindstillinger</p>
                                
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Auto-logout</h4>
                                        <p>Log automatisk ud efter inaktivitet</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="auto-logout" onchange="window.appManager.toggleAutoLogout()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>

                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Gem Indstillinger Lokalt</h4>
                                        <p>Gem indstillinger i browserens lokale lager</p>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="save-settings" checked onchange="window.appManager.toggleSaveSettings()">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>

                                <div class="setting-actions">
                                    <button class="btn btn-secondary" onclick="window.appManager.resetSettings()">Nulstil Indstillinger</button>
                                    <button class="btn btn-danger" onclick="window.appManager.clearAllData()">Slet Alle Data</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Firebase Configuration - SECURE VERSION -->
    <script src="firebase-config-secure.js"></script>
    
    <!-- App Script -->
    <!-- Weather Station Popup -->
    <div id="weather-popup" class="weather-popup">
        <div class="weather-popup-content">
            <div class="weather-popup-header">
                <h3>Udvendig Vejrstation</h3>
                <button class="weather-popup-close">&times;</button>
            </div>
            <div class="weather-popup-body">
                <div class="weather-setting">
                    <label for="outdoor-temp-input">Udvendig Temperatur</label>
                    <div class="weather-input-group">
                        <input type="range" id="outdoor-temp-input" min="-10" max="40" value="15" class="weather-slider">
                        <span class="weather-input-value" id="outdoor-temp-display">15¬∞C</span>
                    </div>
                </div>
                <div class="weather-setting">
                    <label for="outdoor-light-input">Udvendig Lysstyrke</label>
                    <div class="weather-input-group">
                        <input type="range" id="outdoor-light-input" min="0" max="100" value="0" class="weather-slider">
                        <span class="weather-input-value" id="outdoor-light-display">M√∏rkt</span>
                    </div>
                </div>
            </div>
            <div class="weather-popup-footer">
                <button class="weather-save-btn">Gem Indstillinger</button>
            </div>
        </div>
    </div>
    
    <!-- Fugtm√•ler Popup -->
    <div id="humidity-popup" class="humidity-popup">
        <div class="humidity-popup-content">
            <div class="humidity-popup-header">
                <h3>Badev√¶relse Fugtm√•ler</h3>
                <button class="humidity-popup-close">&times;</button>
            </div>
            <div class="humidity-popup-body">
                <div class="humidity-setting">
                    <label for="humidity-slider">Fugtniveau: <span id="humidity-value">45</span>%</label>
                    <div class="humidity-input-group">
                        <input type="range" id="humidity-slider" class="humidity-slider" min="30" max="80" value="45">
                    </div>
                </div>
            </div>
            <div class="humidity-popup-footer">
                <button class="humidity-save-btn">Gem Indstillinger</button>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
    
    <!-- Debug Console Helper -->
    <script>
        // Add helpful debug functions to console
        window.debugFirebase = {
            clearData: () => {
                if (window.FirebaseConfig && window.FirebaseConfig.clearFirestoreData) {
                    window.FirebaseConfig.clearFirestoreData().then(() => {
                        console.log('üîÑ Refresh the page to complete the cleanup');
                        if (confirm('Data cleared! Refresh the page now to complete the setup?')) {
                            window.location.reload();
                        }
                    });
                } else {
                    console.log('‚ö†Ô∏è Firebase not initialized yet');
                }
            },
            status: () => {
                if (window.FirebaseConfig && window.FirebaseConfig.isFirebaseReady) {
                    const isReady = window.FirebaseConfig.isFirebaseReady();
                    console.log('Firebase Status:', isReady ? '‚úÖ Ready' : '‚ùå Not Ready');
                    return isReady;
                } else {
                    console.log('‚ö†Ô∏è Firebase not initialized yet');
                    return false;
                }
            },
            refresh: () => {
                console.log('üîÑ Refreshing page...');
                window.location.reload();
            }
        };
        
        console.log('üîß Debug functions available:');
        console.log('  - debugFirebase.clearData() - Clear Firestore data');
        console.log('  - debugFirebase.status() - Check Firebase status');
        console.log('  - debugFirebase.refresh() - Refresh the page');
    </script>

    <!-- Advanced Mode Password Popup -->
    <div id="advanced-password-popup" class="password-popup">
        <div class="password-popup-content">
            <div class="password-popup-header">
                <h3>üîê Advanced Mode</h3>
                <p>Indtast koden for at aktivere avancerede funktioner</p>
            </div>
            <div class="password-popup-body">
                <div class="password-input-group">
                        <input type="password" id="advanced-password-input" placeholder="Indtast kode..." autocomplete="current-password" maxlength="20">
                    <button type="button" id="toggle-password-visibility" class="password-toggle">
                        <span class="password-icon">üëÅÔ∏è</span>
                    </button>
                </div>
            </div>
            <div class="password-popup-footer">
                <button type="button" id="cancel-password" class="btn btn-secondary">Annuller</button>
                <button type="button" id="submit-password" class="btn btn-primary">Aktiver</button>
            </div>
        </div>
    </div>

    <!-- D√¶mper Dialog Popup -->
    <div id="dimmer-dialog" class="dimmer-popup">
        <div class="dimmer-popup-content">
            <div class="dimmer-popup-header">
                <h3>üîÜ D√¶mper Indstillinger</h3>
                <button class="close-btn" onclick="window.appManager.closeDimmerDialog()">&times;</button>
            </div>
            <div class="dimmer-popup-body">
                <div class="dimmer-control">
                    <label>V√¶rdi (%):</label>
                    <input type="range" id="dimmer-slider" min="0" max="100" value="0" oninput="window.appManager.updateDimmerValue(this.value)">
                    <div class="dimmer-value-display">
                        <span id="dimmer-current-value">0</span>%
                    </div>
                </div>
                <div class="dimmer-presets">
                    <button class="btn btn-small" onclick="window.appManager.setDimmerValue(25)">25%</button>
                    <button class="btn btn-small" onclick="window.appManager.setDimmerValue(50)">50%</button>
                    <button class="btn btn-small" onclick="window.appManager.setDimmerValue(75)">75%</button>
                    <button class="btn btn-small" onclick="window.appManager.setDimmerValue(100)">100%</button>
                </div>
            </div>
            <div class="dimmer-popup-footer">
                <button class="btn btn-secondary" onclick="window.appManager.closeDimmerDialog()">Annuller</button>
                <button class="btn btn-primary" onclick="window.appManager.applyDimmerValue()">Anvend</button>
            </div>
        </div>
    </div>
</body>
</html>
